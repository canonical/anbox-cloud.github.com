<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>anbox-platform-sdk: API Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">anbox-platform-sdk
   &#160;<span id="projectnumber">1.26.0</span>
   </div>
   <div id="projectbrief">Anbox Platform SDK API documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('anbox_sdk_api_overview_page.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">API Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page provides a high-level overview of the entire Anbox Platform SDK API, including those defined in <a class="el" href="platform_8h.html">platform.h</a>, <a class="el" href="audio__processor_8h.html">audio_processor.h</a>, <a class="el" href="graphics__processor_8h.html">graphics_processor.h</a> <a class="el" href="sensor__processor_8h.html">sensor_processor.h</a> and <a class="el" href="input__processor_8h.html">input_processor.h</a>.</p>
<h1><a class="anchor" id="API"></a>
Introduction</h1>
<p>The Anbox Platform SDK provides a class based C++ API to implement plugins in. The internal implementation wraps C-based API functions and exposes them for Anbox internal use. The platform plugin implementer only needs to use the stable C++ based API like <a class="el" href="classanbox_1_1Platform.html">anbox::Platform</a>, <a class="el" href="classanbox_1_1InputProcessor.html">anbox::InputProcessor</a>, <a class="el" href="classanbox_1_1GraphicsProcessor.html">anbox::GraphicsProcessor</a>, <a class="el" href="classanbox_1_1SensorProcessor.html">anbox::SensorProcessor</a>, <a class="el" href="classanbox_1_1AudioProcessor.html">anbox::AudioProcessor</a>, <a class="el" href="classanbox_1_1GpsProcessor.html">anbox::GpsProcessor</a> and <a class="el" href="classanbox_1_1CameraProcessor.html">anbox::CameraProcessor</a>. Any usage of the internal C exposed functions is not guaranteed to be stable and could break at any point. </p><div class="image">
<img src="classes_abstract.png" alt=""/>
</div>
<p>The intent of the API design is to provide a platform implementation that the Anbox runtime calls into. The plugin shouldn't ever call into Anbox, instead Anbox will always call functions that the plugin implements. Internally this is accomplished with C style ABI compatibility with the exported functions that are dynamically loaded by Anbox. These C functions essentially call the methods of an instance of the <a class="el" href="classanbox_1_1Platform.html">anbox::Platform</a> class. They are exported at compile time of the plugin, as the implementation of the SDK is compiled alongside the SDK using CMake interface targets.</p>
<p>The platform plugin should implement an inherited subclass of the <a class="el" href="classanbox_1_1Platform.html">anbox::Platform</a>. The resulting platform plugin is a shared library that can be loaded dynamically by external platform instance at Anbox runtime. This dynamic library can have any other external libraries linked to it. The example <a class="el" href="anbox_sdk_example_audio_streaming.html">Audio Streaming Platform</a> platform uses <em><b>libav</b> </em>(<a href="https://www.libav.org/">https://www.libav.org/</a>) libraries to encode audio data sent from Anbox and stream it over RTP to an on demand connected client.</p>
<p>The plugin dynamic libary uses the <a class="el" href="structAnboxPlatformDescriptor.html">AnboxPlatformDescriptor</a> macro to describe basic information about the plugin needed by Anbox to load the plugin: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">field   </th><th class="markdownTableHeadNone">meaning    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">platform   </td><td class="markdownTableBodyNone">The platform class implementation.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">name   </td><td class="markdownTableBodyNone">The name of the platform.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">vendor   </td><td class="markdownTableBodyNone">The vendor name of the platform.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">description   </td><td class="markdownTableBodyNone">The description of the platform.   </td></tr>
</table>
<p>This macro will generate and export 2 functions which the Anbox runtime then calls into. The 2 functions are an initialize function which creates an instance of the platform object the plugin describes and registers the object with Anbox, as well as a deinitialize function which destroys the object and unregisters the plugin. The name and vendor fields are also used by Anbox to verify platform API version, validate the plugin at external platform startup, and revoke the platform plugin access to Anbox platform if they are invalid.</p>
<h1><a class="anchor" id="abstract_classes"></a>
Abstract classes</h1>
<p><a class="el" href="classanbox_1_1Platform.html">anbox::Platform</a>, <a class="el" href="classanbox_1_1Platform.html#a4ab51c5daf0c30f5e1cbca6fec1f1499">anbox::Platform::audio_processor</a>, <a class="el" href="classanbox_1_1Platform.html#a3455195c7b102a54647d4f1aec85618c">anbox::Platform::graphics_processor</a>, <a class="el" href="classanbox_1_1Platform.html#af0ada09473c66da26efafa0828fe74d7">anbox::Platform::sensor_processor</a>, <a class="el" href="classanbox_1_1Platform.html#a3455195c7b102a54647d4f1aec85618c">anbox::Platform::graphics_processor</a> and <a class="el" href="classanbox_1_1Platform.html#a02ef565c2757d395fe86333175d3a2a8">anbox::Platform::input_processor</a> are abstract base classes that are to be implemented by plugins to provide a custom platform, audio processor, and input processor. A platform plugin must implement each subclasses that implements all inherited abstract methods to become a concrete class.</p>
<p>The <a class="el" href="classanbox_1_1Platform.html">anbox::Platform</a> class declares the following virtual functions:</p>
<ul>
<li><a class="el" href="classanbox_1_1Platform.html#a4ab51c5daf0c30f5e1cbca6fec1f1499">anbox::Platform::audio_processor</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a02ef565c2757d395fe86333175d3a2a8">anbox::Platform::input_processor</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#af0ada09473c66da26efafa0828fe74d7">anbox::Platform::sensor_processor</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a3455195c7b102a54647d4f1aec85618c">anbox::Platform::graphics_processor</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a33ae2ef994dd4760e07af982b452be91">anbox::Platform::gps_processor</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a90ff17206a0fc0cb05cfdaf8caf6d782">anbox::Platform::get_config_item</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a3cfb767fac35c8e355923f7d85327b9c">anbox::Platform::ready</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a7d8fa1d14143a5af92de58deb780ea40">anbox::Platform::wait_until_ready</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#af7a0fcf1b3d7f08a47b880215b63745c">anbox::Platform::stop</a></li>
<li><a class="el" href="classanbox_1_1Platform.html#a3c6d0ac26305e68bdb19e1c3bcaa528b">anbox::Platform::handle_event</a></li>
</ul>
<p>The first pure virtual function, <a class="el" href="classanbox_1_1Platform.html#a4ab51c5daf0c30f5e1cbca6fec1f1499">anbox::Platform::audio_processor()</a>, returns the audio processor provided by the platform plugin as a <a class="el" href="classanbox_1_1AudioProcessor.html">anbox::AudioProcessor</a>. Similarly, <a class="el" href="classanbox_1_1Platform.html#a02ef565c2757d395fe86333175d3a2a8">anbox::Platform::input_processor()</a> returns the input processor as a <a class="el" href="classanbox_1_1InputProcessor.html">anbox::InputProcessor</a>, <a class="el" href="classanbox_1_1Platform.html#af0ada09473c66da26efafa0828fe74d7">anbox::Platform::sensor_processor()</a> returns the sensor processor as a anbox::Platform::SensorProcessor and <a class="el" href="classanbox_1_1Platform.html#a3455195c7b102a54647d4f1aec85618c">anbox::Platform::graphics_processor()</a> returns the graphics processor as a anbox::Platform::GraphicsProcessor. All of these subclasses have to be implemented as described below.</p>
<p>The pure virtual function <a class="el" href="classanbox_1_1Platform.html#a90ff17206a0fc0cb05cfdaf8caf6d782">anbox::Platform::get_config_item</a>, takes a <a class="el" href="types_8h.html#a0ea2707450519d64745267790a9f2f0d">AnboxPlatformConfigurationKey</a>, a <code>data</code> value pointer and a <code>data_size</code> as parameters, returning 0 when managing to retrieve configuration options provided by the platform plugin. This function makes it possible to pass the plugin-specific configurations to Anbox.</p>
<p>The available configuration keys that are supported by Anbox are as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Configuration keys   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">EGL_DRIVER_PATH   </td><td class="markdownTableBodyNone">Path to the platform implementation of the EGL shared library    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OPENGL_ES1_CM_DRIVER_PATH   </td><td class="markdownTableBodyNone">Path to the platform implementation of the OpenGL ES 2.x shared library    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DISPLAY_SPEC   </td><td class="markdownTableBodyNone">Specification of parameters of the virtual display Anbox creates <br  />
 (NOTE: deprecated, it exists only for backward compatibility. Please use DISPLAY_SPEC2 instead.)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AUDIO_SPEC   </td><td class="markdownTableBodyNone">Specification of parameters of the audio output Anbox creates    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DISPLAY_SPEC2   </td><td class="markdownTableBodyNone">Specification of parameters of the virtual display Anbox creates    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AUDIO_INPUT_SPEC   </td><td class="markdownTableBodyNone">Specification of parameters of the audio input Anbox creates   </td></tr>
</table>
<p>The function <a class="el" href="classanbox_1_1Platform.html#a3cfb767fac35c8e355923f7d85327b9c">anbox::Platform::ready</a>, is used to query the platform for its ready status, returning true once the platform plugin is ready to perform any further operation, otherwise false if it is not ready yet to be used. <a class="el" href="classanbox_1_1Platform.html#a3cfb767fac35c8e355923f7d85327b9c">anbox::Platform::ready</a> will be called in conjunction with <a class="el" href="classanbox_1_1Platform.html#a7d8fa1d14143a5af92de58deb780ea40">anbox::Platform::wait_until_ready</a> by Anbox to check the platform plugin status on startup. <a class="el" href="classanbox_1_1Platform.html#a7d8fa1d14143a5af92de58deb780ea40">anbox::Platform::wait_until_ready</a> should return an error when something goes wrong. Generally, it's useful to perform the long time or blocked operations in <a class="el" href="classanbox_1_1Platform.html#a7d8fa1d14143a5af92de58deb780ea40">anbox::Platform::wait_until_ready</a> instead of the platform constructor.</p>
<p>The func <a class="el" href="classanbox_1_1Platform.html#af7a0fcf1b3d7f08a47b880215b63745c">anbox::Platform::stop</a> is used by Anbox to tell the platform implementation to stop all of its activity in preparation for Anbox to initiate its termination sequence. It is called before the Android container is terminated. The platform should not provide any further data after <a class="el" href="classanbox_1_1Platform.html#af7a0fcf1b3d7f08a47b880215b63745c">anbox::Platform::stop</a> has succeeded and free up all resources.</p>
<p>The func <a class="el" href="classanbox_1_1Platform.html#a3c6d0ac26305e68bdb19e1c3bcaa528b">anbox::Platform::handle_event</a> is used by Anbox to fire some key events which are crucial for a platform initialization if some operations of the platform (E.g. trigger an action) or initialization routine requires Android container fully booted or all essential components of Anbox are fully initialized.</p>
<p>The events that are fired by Anbox event as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Event type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ANBOX_EVENT_TYPE_ANDROID_BOOT_FINISHED   </td><td class="markdownTableBodyNone">Android container is fully booted    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ANBOX_EVENT_TYPE_INITIALIZATION_FINISHED   </td><td class="markdownTableBodyNone">All essential components of Anbox are fully initialized    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ANBOX_EVENT_TYPE_TERMINATING   </td><td class="markdownTableBodyNone">Android container is shutting down and Anbox is terminating all essential components   </td></tr>
</table>
<h2><a class="anchor" id="anbox_audio_processor"></a>
AudioProcessor</h2>
<p>The <a class="el" href="classanbox_1_1AudioProcessor.html">anbox::AudioProcessor</a> class declares the following virtual functions:</p>
<ul>
<li><a class="el" href="classanbox_1_1AudioProcessor.html#a93b5f068d850604529cb03687373792c">anbox::AudioProcessor::process_data</a></li>
<li><a class="el" href="classanbox_1_1AudioProcessor.html#a3446f1e075788eada9f4434fa25d973b">anbox::AudioProcessor::write_data</a></li>
<li><a class="el" href="classanbox_1_1AudioProcessor.html#ab09bbc0c384613d7056a5d0a0d338c96">anbox::AudioProcessor::read_data</a></li>
<li><a class="el" href="classanbox_1_1AudioProcessor.html#acfbc1ee7af52339cf30c49dd44baea52">anbox::AudioProcessor::standby</a></li>
<li><a class="el" href="classanbox_1_1AudioProcessor.html#aba43b545d797e73eff50b997366c80b9">anbox::AudioProcessor::need_silence_on_standby</a></li>
</ul>
<p>The first pure virtual function, <a class="el" href="classanbox_1_1AudioProcessor.html#a93b5f068d850604529cb03687373792c">anbox::AudioProcessor::process_data</a> is deprecated and replaced by the second virtual function <a class="el" href="classanbox_1_1AudioProcessor.html#ab09bbc0c384613d7056a5d0a0d338c96">anbox::AudioProcessor::read_data</a>, which takes a data pointer which is passed directly by Anbox representing a chunk of audio data and its size as parameters, returning the actual number of bytes processed by the platform plugin or an error code on failure. With this function, a plugin can perform audio encoding with a suitable audio format for the plugin and stream as needed by utilizing the 3rd-party libraries such as libav.</p>
<p>The third virtual function, <a class="el" href="classanbox_1_1AudioProcessor.html#ab09bbc0c384613d7056a5d0a0d338c96">anbox::AudioProcessor::read_data</a>, takes a data pointer which is passed directly by Anbox representing an uninitialized chunk of audio data and its size as parameters, returning the number of actual bytes for the audio data that was read by the platform plugin. With this function, a plugin can perform audio recording with a suitable audio format for the plugin and stream as needed by utilizing the 3rd-party libraries such as libav.</p>
<p>The fourth virtual function, <a class="el" href="classanbox_1_1AudioProcessor.html#acfbc1ee7af52339cf30c49dd44baea52">anbox::AudioProcessor::standby</a>, will be called when an audio stream enters standby mode. If a platform is notified by Anbox that one audio stream is going to standby mode, it's always good to drain the audio buffer cached on the platform side since this reduces the accumulated latency efficiently.</p>
<p>The virtual function, <a class="el" href="classanbox_1_1AudioProcessor.html#aba43b545d797e73eff50b997366c80b9">anbox::AudioProcessor::need_silence_on_standby</a>, will be called by Anbox whether to produce a silent audio stream while the audio output stream goes into the standby state. Producing a silent audio stream helps with the audio latency reduction when doing audio playback if no audio output device is installed on a platform.</p>
<h2><a class="anchor" id="anbox_input_processor"></a>
InputProcessor</h2>
<p>The <a class="el" href="classanbox_1_1InputProcessor.html">anbox::InputProcessor</a> class declares two pure virtual functions.</p>
<ul>
<li><a class="el" href="classanbox_1_1InputProcessor.html#a5a0da2efa170c72758095d60a19c44ae">anbox::InputProcessor::read_event</a></li>
<li><a class="el" href="classanbox_1_1InputProcessor.html#a9f6a16f84c5c82559d9ad5792baeb8dc">anbox::InputProcessor::inject_event</a></li>
</ul>
<p>The first pure virtual function, <a class="el" href="classanbox_1_1InputProcessor.html#a5a0da2efa170c72758095d60a19c44ae">anbox::InputProcessor::read_event</a>, is called by Anbox to query the plugin for the next available event (represented as a <a class="el" href="structAnboxInputEvent.html">AnboxInputEvent</a> pointer). The received event is then forwarded to the Android container. The <a class="el" href="structAnboxInputEvent.html">AnboxInputEvent</a> is similar to the input_event that is defined in the Linux kernel API. The three member variables <em>type</em>, <em>code</em> and <em>value</em> have the same meaning as defined in the Linux kernel API. See also the Linux Kernel documentation (<a href="https://www.kernel.org/doc/Documentation/input/input.txt">https://www.kernel.org/doc/Documentation/input/input.txt</a>) for more details. The other two member variables <em>device_type</em> and <em>device_id</em> facilitate the event forwarding and can be specified by the plugin to tell Anbox what kind of device the event belongs to. For now, three types of input devices are supported in <a class="el" href="types_8h.html#adf8cc8125db12fa5f76b530f2f9939bc">AnboxInputDeviceType</a></p><ul>
<li>Pointer</li>
<li>Keyboard</li>
<li>Touch panel</li>
<li>Gamepad</li>
</ul>
<p>The second pure virtual function, <a class="el" href="classanbox_1_1InputProcessor.html#a9f6a16f84c5c82559d9ad5792baeb8dc">anbox::InputProcessor::inject_event</a>, allows injecting an <a class="el" href="structAnboxInputEvent.html">AnboxInputEvent</a> into the platform and letting the InputProcessor handle the input events.<br  />
<b>Note:</b> This function is only used in the test suite to facilitate test automation tests and it is subject to change at any time.</p>
<h2><a class="anchor" id="anbox_graphics_processor"></a>
GraphicsProcessor</h2>
<p>The <a class="el" href="classanbox_1_1GraphicsProcessor.html">anbox::GraphicsProcessor</a> class declares the following functions:</p>
<ul>
<li><a class="el" href="classanbox_1_1GraphicsProcessor.html#abcea3c95c981a93e3fff222cb2043019">anbox::GraphicsProcessor::initialize</a></li>
<li><a class="el" href="classanbox_1_1GraphicsProcessor.html#a86e36406f5f12623490d52dee6ae46be">anbox::GraphicsProcessor::begin_frame</a></li>
<li><a class="el" href="classanbox_1_1GraphicsProcessor.html#aa19aff292101d04ba4cfc8fd7749003c">anbox::GraphicsProcessor::finish_frame</a></li>
<li><a class="el" href="classanbox_1_1GraphicsProcessor.html#a4d5c953b99b75f31f2e6c0d185c23ca0">anbox::GraphicsProcessor::create_offscreen_surface</a></li>
<li><a class="el" href="classanbox_1_1GraphicsProcessor.html#a104f313b0f08d6ea96f7efb5b44d5447">anbox::GraphicsProcessor::destroy_offscreen_surface</a></li>
</ul>
<p>The function <a class="el" href="classanbox_1_1GraphicsProcessor.html#abcea3c95c981a93e3fff222cb2043019">anbox::GraphicsProcessor::initialize</a> is called when Anbox initializes its rendering pipeline and allows the platform customize certain parts. For example can the platform provide a EGLNativeDisplayType to connect EGL to a display.</p>
<p>The two functions <a class="el" href="classanbox_1_1GraphicsProcessor.html#a86e36406f5f12623490d52dee6ae46be">anbox::GraphicsProcessor::begin_frame</a> and <a class="el" href="classanbox_1_1GraphicsProcessor.html#aa19aff292101d04ba4cfc8fd7749003c">anbox::GraphicsProcessor::finish_frame</a> allow integration into the rendering process inside Anbox. <a class="el" href="classanbox_1_1GraphicsProcessor.html#a86e36406f5f12623490d52dee6ae46be">anbox::GraphicsProcessor::begin_frame</a> is called before a new frame is rendered and <a class="el" href="classanbox_1_1GraphicsProcessor.html#aa19aff292101d04ba4cfc8fd7749003c">anbox::GraphicsProcessor::finish_frame</a> before its being finish and eglSwapBuffers is called. This allows rendering an entire frame to a specific OpenGL framebuffer or texture in order to enable for example zero copy video encoding.</p>
<p>The function <a class="el" href="classanbox_1_1GraphicsProcessor.html#a4d5c953b99b75f31f2e6c0d185c23ca0">anbox::GraphicsProcessor::create_offscreen_surface</a> allows a platform to create an offscreen EGL surface for the given display, configuration and attributes. If this virtual function is not overridden, Anbox will use eglCreatePbufferSurface as fallback. The surface created with <a class="el" href="classanbox_1_1GraphicsProcessor.html#a4d5c953b99b75f31f2e6c0d185c23ca0">anbox::GraphicsProcessor::create_offscreen_surface</a> can be destroyed via <a class="el" href="classanbox_1_1GraphicsProcessor.html#a104f313b0f08d6ea96f7efb5b44d5447">anbox::GraphicsProcessor::destroy_offscreen_surface</a>. If it's not overridden, Anbox will use eglDestroySurface as fallback.</p>
<h2><a class="anchor" id="anbox_sensor_processor"></a>
SensorProcessor</h2>
<p>The <a class="el" href="classanbox_1_1SensorProcessor.html">anbox::SensorProcessor</a> class declares two pure virtual functions.</p>
<ul>
<li><a class="el" href="classanbox_1_1SensorProcessor.html#a503eca5e80480d6f62d5cc7970264188">anbox::SensorProcessor::supported_sensors</a></li>
<li><a class="el" href="classanbox_1_1SensorProcessor.html#a6be51ee1116dc036c5b7c642036af76c">anbox::SensorProcessor::read_data</a></li>
<li><a class="el" href="classanbox_1_1SensorProcessor.html#aaade1f91f7fce6e904d6f358c8162bb5">anbox::SensorProcessor::inject_data</a></li>
</ul>
<p>The first pure virtual function, anbox::Platform::supported_sensors(), returns a list of sensors the processor supports. Multiple sensor types can be specified by using the OR bitwise operator.</p>
<p>The second pure virtual function, <a class="el" href="classanbox_1_1SensorProcessor.html#a6be51ee1116dc036c5b7c642036af76c">anbox::SensorProcessor::read_data</a>, is called by Anbox to query the plugin for available sensor data (represented as a <a class="el" href="structAnboxSensorData.html">AnboxSensorData</a>). The received data is then forwarded to the Android container. <a class="el" href="structAnboxSensorData.html">AnboxSensorData</a> consists of two member variables <em>sensor_type</em>, and an union data type, which consists of a variety of sensor data. E.g. the data type for 3-axis accelerometer sensor is <a class="el" href="structAnboxSensorVector.html">AnboxSensorVector</a>, which is a data structure represents acceleration along each device axis or current device rotation angles: azimuth, pitch, roll.</p>
<p>The available sensor types that are supported by Anbox are as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Sensor type   </th><th class="markdownTableHeadNone">Enum value   </th><th class="markdownTableHeadNone">Data type    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3-axis Accelerometer   </td><td class="markdownTableBodyNone">(AnboxSensorType::ACCELERATION)   </td><td class="markdownTableBodyNone"><a class="el" href="structAnboxSensorVector.html" title="AnboxSensorVector represents acceleration along each device axis or current device rotation angles: a...">AnboxSensorVector</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3-axis Gyroscope   </td><td class="markdownTableBodyNone">(AnboxSensorType::GYROSCOPE)   </td><td class="markdownTableBodyNone"><a class="el" href="structAnboxSensorVector.html" title="AnboxSensorVector represents acceleration along each device axis or current device rotation angles: a...">AnboxSensorVector</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3-axis Magnetic field   </td><td class="markdownTableBodyNone">(AnboxSensorType::MAGNETOMETER)   </td><td class="markdownTableBodyNone"><a class="el" href="structAnboxSensorVector.html" title="AnboxSensorVector represents acceleration along each device axis or current device rotation angles: a...">AnboxSensorVector</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Orientation   </td><td class="markdownTableBodyNone">(AnboxSensorType::ORIENTATION)   </td><td class="markdownTableBodyNone"><a class="el" href="structAnboxSensorVector.html" title="AnboxSensorVector represents acceleration along each device axis or current device rotation angles: a...">AnboxSensorVector</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ambient Temperature   </td><td class="markdownTableBodyNone">(AnboxSensorType::TEMPERATURE)   </td><td class="markdownTableBodyNone">float    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Proximity   </td><td class="markdownTableBodyNone">(AnboxSensorType::PROXIMITY)   </td><td class="markdownTableBodyNone">float    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Light   </td><td class="markdownTableBodyNone">(AnboxSensorType::LIGHT)   </td><td class="markdownTableBodyNone">float    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pressure   </td><td class="markdownTableBodyNone">(AnboxSensorType::PRESSURE)   </td><td class="markdownTableBodyNone">float    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Humidity   </td><td class="markdownTableBodyNone">(AnboxSensorType::HUMIDITY)   </td><td class="markdownTableBodyNone">float   </td></tr>
</table>
<p>The third pure virtual function, <a class="el" href="classanbox_1_1SensorProcessor.html#aaade1f91f7fce6e904d6f358c8162bb5">anbox::SensorProcessor::inject_data</a>, allows injecting a <a class="el" href="structAnboxSensorData.html">AnboxSensorData</a> into the platform and letting the SensorProcessor handle the sensor data.<br  />
<b>Note:</b> This function is only used in the test suite to facilitate test automation tests and it is subject to change at any time.</p>
<h2><a class="anchor" id="anbox_proxy"></a>
AnboxProxy</h2>
<p>The <a class="el" href="classanbox_1_1AnboxProxy.html">anbox::AnboxProxy</a> class provides a proxy layer that encapsulates callbacks that can be used by a platform to change Android system behaviors. E.g. change the screen orientation. The platform can invoke the callbacks which are provided by Anbox on demand when triggering an action or changing a behavior. The <a class="el" href="classanbox_1_1AnboxProxy.html">anbox::AnboxProxy</a> class declares a few member functions.</p>
<ul>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a59b5d87df0950408f6afc1314752eec3">anbox::AnboxProxy::change_screen_orientation</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a2590a55c45b9dbdeaaa2250f67456828">anbox::AnboxProxy::set_change_screen_orientation_callback</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#acaecd05dd474572e753887d0d82c0461">anbox::AnboxProxy::change_display_density</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a890bec8aad1f7bbb0d9d5e369ed4d13d">anbox::AnboxProxy::set_change_display_density_callback</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a48cb35438285268f87978adaa1e44fc9">anbox::AnboxProxy::change_display_size</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a0082ec7ce8b7dc54905bb0be64298851">anbox::AnboxProxy::set_change_display_size_callback</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a4f66c8b7d37198edb89300e0be7329ef">anbox::AnboxProxy::send_message</a></li>
<li><a class="el" href="classanbox_1_1AnboxProxy.html#a3a3889387a1bda7ec1af5ad193affb62">anbox::AnboxProxy::trigger_action</a></li>
</ul>
<p>The first member function, <a class="el" href="classanbox_1_1AnboxProxy.html#a59b5d87df0950408f6afc1314752eec3">anbox::AnboxProxy::change_screen_orientation</a>, can be used by platform plugin to change the screen orientation. For example, when a platform detect that screen rotation changes, it can call this function to change the screen orientation in Android container to honor the rotation detection on a platform plugin.</p>
<p>The available orientation types that are supported by Anbox are as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Orientation type   </th><th class="markdownTableHeadNone">Enum value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Portrait mode   </td><td class="markdownTableBodyNone">(AnboxScreenOrientationType::PORTRAIT)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Landscape mode   </td><td class="markdownTableBodyNone">(AnboxScreenOrientationType::LANDSCAPE)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Reversed portrait mode   </td><td class="markdownTableBodyNone">(AnboxScreenOrientationType::PORTRAIT_REVERSED)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Reversed landscape mode   </td><td class="markdownTableBodyNone">(AnboxScreenOrientationType::LANDSCAPE_REVERSED)   </td></tr>
</table>
<p>The second member function, <a class="el" href="classanbox_1_1AnboxProxy.html#a2590a55c45b9dbdeaaa2250f67456828">anbox::AnboxProxy::set_change_screen_orientation_callback</a>, is called by Anbox to set the screen orientation change callback function to the platform. The callback function will be invoked internally when <a class="el" href="classanbox_1_1AnboxProxy.html#a59b5d87df0950408f6afc1314752eec3">anbox::AnboxProxy::change_screen_orientation</a> is called by the platform plugin if it's registered by the Anbox. If the callback function is not registered properly by Anbox, the EINVAL error will be returned.</p>
<p>The third member function, <a class="el" href="classanbox_1_1AnboxProxy.html#acaecd05dd474572e753887d0d82c0461">anbox::AnboxProxy::change_display_density</a>, can be used by platform plugin to adjust the display density to your preferred screen. When <a class="el" href="classanbox_1_1AnboxProxy.html#acaecd05dd474572e753887d0d82c0461">anbox::AnboxProxy::change_display_density</a> is called by the platform plugin, a callback function which is registered by the Anbox via <a class="el" href="classanbox_1_1AnboxProxy.html#a890bec8aad1f7bbb0d9d5e369ed4d13d">anbox::AnboxProxy::set_change_display_density_callback</a> will be invoked internally. If the callback function is not registered properly by Anbox, the EINVAL error will be returned.</p>
<p>The fifth member function, <a class="el" href="classanbox_1_1AnboxProxy.html#a48cb35438285268f87978adaa1e44fc9">anbox::AnboxProxy::change_display_size</a>, can be used by platform plugin to adjust the display size to better fit the screen. When <a class="el" href="classanbox_1_1AnboxProxy.html#a48cb35438285268f87978adaa1e44fc9">anbox::AnboxProxy::change_display_size</a> is called by the platform plugin, a callback function which is registered by the Anbox via <a class="el" href="classanbox_1_1AnboxProxy.html#a0082ec7ce8b7dc54905bb0be64298851">anbox::AnboxProxy::set_change_display_size_callback</a> will be invoked internally. If the callback function is not registered properly by Anbox, the EINVAL error will be returned.</p>
<p>The <a class="el" href="classanbox_1_1AnboxProxy.html#a4f66c8b7d37198edb89300e0be7329ef">anbox::AnboxProxy::send_message</a>, can be used by a platform plugin to send a message from Anbox to the Platform. A common use case is that a message sent by an application running in the container is forwarded to a Platform via Anbox. And platform should get a response to the message and accurately reflect it on the UI or for further processing by the platform during the data transportation.</p>
<p>The <a class="el" href="classanbox_1_1AnboxProxy.html#a3a3889387a1bda7ec1af5ad193affb62">anbox::AnboxProxy::trigger_action</a>, can be used by a platform plugin to trigger an action to be executed within the Android container. The action script must be installed at the ANDROID_ROOTFS/system/bin/anbox/actions folder ahead of the execution. This can be done by utilizing the hooks of an <a href="https://anbox-cloud.io/docs/manage/managing-addons">addon</a>. <br  />
<b>Note:</b> the function parameter <code>args</code> only stands for the parameter to action and unlike standard C the action name must not be included in the parameters. So does <code>args_len</code> only reflects the number of parameters, action_name must not be counted. Also the returned value 0 only implies the request to launch action is handled by Anbox successfully, it doesn't tell if the action is invoked successfully within the Android container or not. To check the actual error message if an action script is not executed successfully within the Android container, please view the log of anbox service unit.</p>
<h2><a class="anchor" id="anbox_gps_processor"></a>
GpsProcessor</h2>
<p>The <a class="el" href="classanbox_1_1GpsProcessor.html">anbox::GpsProcessor</a> class declares two pure virtual functions.</p>
<ul>
<li><a class="el" href="classanbox_1_1GpsProcessor.html#a9b2339b4ef39c25b2bbabaa220b1276e">anbox::GpsProcessor::read_data</a></li>
<li><a class="el" href="classanbox_1_1GpsProcessor.html#a929837a6a46f37d9b5cd6f015f1a732d">anbox::GpsProcessor::inject_data</a></li>
</ul>
<p>The first pure virtual function, <a class="el" href="classanbox_1_1GpsProcessor.html#a9b2339b4ef39c25b2bbabaa220b1276e">anbox::GpsProcessor::read_data</a>, is called by Anbox to query the plugin for the next available gps data (represented as a <a class="el" href="structAnboxGpsData.html">AnboxGpsData</a> pointer), which is an NMEA sentences structure essentially. The received data is then forwarded to the Android container. The available gps NEMA sentences that are supported by Anbox are following:</p><ul>
<li>GGA NEMA sentence</li>
<li>RMC NEMA sentence</li>
<li>GNSS NEMA sentence</li>
</ul>
<p>Please check the NMEA standard sentences documentation (<a href="http://www.gpsinformation.org/dale/nmea.htm">http://www.gpsinformation.org/dale/nmea.htm</a>) for more details.</p>
<p>The second pure virtual function, <a class="el" href="classanbox_1_1GpsProcessor.html#a929837a6a46f37d9b5cd6f015f1a732d">anbox::GpsProcessor::inject_data</a>, allows injecting an <a class="el" href="structAnboxGpsData.html">AnboxGpsData</a> into the platform and letting the GpsProcessor handle the gps data.<br  />
<b>Note:</b> This function is only used in the test suite to facilitate test automation tests and it is subject to change at any time.</p>
<h2><a class="anchor" id="anbox_camera_processor"></a>
CameraProcessor</h2>
<p>The <a class="el" href="classanbox_1_1CameraProcessor.html">anbox::CameraProcessor</a> class declares a few virtual functions.</p>
<ul>
<li><a class="el" href="classanbox_1_1CameraProcessor.html#a2cebe02bbd5e4ff9fa3e8767ed56f8d9">anbox::CameraProcessor::get_device_specs</a></li>
<li><a class="el" href="classanbox_1_1CameraProcessor.html#a967b5d97bae600bb3d73d9d5477abf30">anbox::CameraProcessor::open_device</a></li>
<li><a class="el" href="classanbox_1_1CameraProcessor.html#a051e33b1fa7c073e03bdec0e083bb8df">anbox::CameraProcessor::close_device</a></li>
<li><a class="el" href="classanbox_1_1CameraProcessor.html#ae759e0e80a73be14c394954d4a0f81f4">anbox::CameraProcessor::read_frame</a></li>
<li><a class="el" href="classanbox_1_1CameraProcessor.html#a3df209945228c24cb648edbededee688">anbox::CameraProcessor::inject_frame</a></li>
</ul>
<p>The first virtual function, <a class="el" href="classanbox_1_1CameraProcessor.html#a2cebe02bbd5e4ff9fa3e8767ed56f8d9">anbox::CameraProcessor::get_device_specs</a>, is called by Anbox to retrieve all the specifications of camera that the platform supports. The camera specifications will be forwarded to Android container by Anbox when the camera service in Android queries the information of the supported camera devices, like resolution, facing-mode, video frame color space format and video frame rate. The camera service can't get started successfully without proper camera specs and in order to send video frames to Android container via Anbox, providing proper camera specs is a must.</p>
<p>The the following video frame color formats are supported by Anbox to camera</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Video color space format   </th><th class="markdownTableHeadNone">Enum value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Standard YUV (4:2:0)   </td><td class="markdownTableBodyNone">(AnboxVideoColorSpaceFormat::VIDEO_FRAME_FORMAT_YUV420)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Raw 32 bit RGBA   </td><td class="markdownTableBodyNone">(AnboxVideoColorSpaceFormat::VIDEO_FRAME_FORMAT_RGBA)   </td></tr>
</table>
<p>The available camera facing modes are following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Facing mode   </th><th class="markdownTableHeadNone">Enum value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Front   </td><td class="markdownTableBodyNone">(AnboxCameraFacingMode::CAMERA_FACING_MODE_FRONT)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Rear or back   </td><td class="markdownTableBodyNone">(AnboxCameraFacingMode::CAMERA_FACING_MODE_REAR)   </td></tr>
</table>
<p>Whenever a camera-based Android application get started and be ready for receiving the video frame sending by a platform for preview, <a class="el" href="classanbox_1_1CameraProcessor.html#a967b5d97bae600bb3d73d9d5477abf30">anbox::CameraProcessor::open_device</a> will be called, the function arguments describe the current camera specification that Android application is using and the current camera sensor orientation as well.</p>
<p>The supported camera sensor orientations as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Camera sensor orientation   </th><th class="markdownTableHeadNone">Enum value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Camera in portrait mode   </td><td class="markdownTableBodyNone">(AnboxCameraOrientation::CAMERA_ORIENTATION_PORTRAIT)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Camera in landscape mode   </td><td class="markdownTableBodyNone">(AnboxCameraOrientation::CAMERA_ORIENTATION_LANDSCAPE)   </td></tr>
</table>
<p>Once <a class="el" href="classanbox_1_1CameraProcessor.html#a967b5d97bae600bb3d73d9d5477abf30">anbox::CameraProcessor::open_device</a> is called, a platform can send video frames by invoking the function <a class="el" href="classanbox_1_1CameraProcessor.html#ae759e0e80a73be14c394954d4a0f81f4">anbox::CameraProcessor::read_frame</a>. This function will give a proper video frame <a class="el" href="structAnboxVideoFrame.html">AnboxVideoFrame</a> back to Anbox. The underlying color format and dimension of video frame buffer must be kept consistent with the camera specification that Android application is requesting (the first function parameter of <a class="el" href="classanbox_1_1CameraProcessor.html#a967b5d97bae600bb3d73d9d5477abf30">anbox::CameraProcessor::open_device</a>). And Anbox will release the video frame after it succeeds in passing the video frame to Android container(Camera HAL).</p>
<p>When a camera stops preview from an Android application, <a class="el" href="classanbox_1_1CameraProcessor.html#a051e33b1fa7c073e03bdec0e083bb8df">anbox::CameraProcessor::close_device</a> will be called consequently. When a platform received this signal, it should stop sending video frames to Anbox immediately and any remaining video frames in the queue should be drop right away.</p>
<p>The last virtual function, <a class="el" href="classanbox_1_1CameraProcessor.html#a3df209945228c24cb648edbededee688">anbox::CameraProcessor::inject_frame</a>, allows injecting an <a class="el" href="structAnboxVideoFrame.html">AnboxVideoFrame</a> into the platform <br  />
<b>Note:</b> This function is only used in the test suite to facilitate test automation tests and it is subject to change at any time. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
